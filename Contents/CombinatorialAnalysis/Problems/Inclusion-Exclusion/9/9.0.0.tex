    \p
در این مسئله، حالت نامطلوب زمانی اتفاق می‌افتد که حداقل یک دسته‌ وجود داشته باشد که اعداد روی هر سه توپ یکسان باشند.
$P(i)$
را تعداد راه‌های دسته‌بندی توپ‌ها 
در حالتی که
 اعداد روی هر سه توپِ حداقل
   $i$
دسته یکسان باشند, در نظر می‌گیریم. پاسخ مسئله
را $N$
و تعداد حالات نامطلوب را
 $A$ 
 می‌نامیم. در نتیجه طبق اصل متمم پاسخ مسئله به صورت زیر محاسبه‌ می‌شود:
$$N = P(0) - A$$
همچنین طبق اصل شمول و عدم شمول برای محاسبه‌ی 
$A$
داریم:
$$A = P(1) - P(2) + P(3) - ... + (-1)^{n-1}P(n)$$
$$= \sum\limits_{i = 1}^n (-1)^{i-1} P(i)$$
برای به دست آوردن مقدار 
$P(i)$
به صورت زیر عمل می‌کنیم:
$$P(i) = \underbrace{{n  \choose i}}_{\text{آ}}\underbrace{(3n - 3i)!}_{\text{ب}}\underbrace{\frac{1}{(3!)^{n - i}}}_{\text{ج}} \underbrace{\frac{1}{(n - i)!}}_{\text{د}}$$
\begin{enumerate}
	\item 
    	$i$
    	 عدد را انتخاب می‌کنیم تا توپ‌های متناظر با این اعداد در 
    	 $i$
    	  دسته قرار بگیرند.
    	
	\item 
        بقیه توپ‌ها را در یک ردیف می‌چینیم.

    \item
		از اول ردیف سه‌تا سه‌تا توپ‌ها را در یک دسته قرار می‌دهیم. در این صورت $n - i$ دسته (غیر از 
    	$i$ 
    	دستهٔ اولی که جدا کردیم) داریم. ولی جایگشت این دسته‌ها برای ما اهمیتی ندارد؛ بنابراین باید جواب را بر $(n-i)!$ تقسیم کنیم.
    
    	
    \item     
		  چون ترتیب اعداد درون دسته‌ها بی‌اهمیت است، حاصل را تقسیم بر
		  $(3!)^{n-i}$
		   می‌کنیم.

    
	\end{enumerate}
    در نهایت $N$ 
    را به صورت زیر به دست می‌آوریم:
	$$N = P(0) - A = P(0) - \sum\limits_{i = 1}^n (-1)^{i-1} P(i) = \sum\limits_{i = 0}^n (-1)^{i} P(i)$$
	$$= \sum\limits_{i = 0}^n (-1)^i {n \choose i} \frac{(3n - 3i)!}{(n - i)! (3!)^{n - i}}$$

   
\SUBSECTION{حل روابط بازگشتی خطی ناهمگن}

\begin{THEOREM}
    اگر 
    $a^{(p)}_n$
    یک
    جواب خاص رابطه‌ بازگشتی خطی ناهمگن با ضرایب ثابت
    \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}+F(n)\]
    باشد،
    آنگاه همه جواب‌ها به فرم 
    $a^{(p)}_n+a^{(h)}_n$
    می‌باشد که
    $a^{(h)}_n$
    جواب رابطه‌ بازگشتی خطی همگن
    \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}\]
    است.
\end{THEOREM}

\begin{PROBLEM}
    \p
    تمام جواب‌های رابطه‌ بازگشتی
    $a_n=4a_{n-1}+3n$
    را به دست آورید.
    \SOLUTION{
        \p
        برای حل این رابطه‌ ابتدا رابطه‌ بازگشتی همگن
        $a_n=4a_{n-1}$
        را حل می‌کنیم:
        $$a_n^{(h)}=\alpha 4^n$$

        حال جواب خاص معادله را به دست می‌آوریم. با توجه به این که
        $F(n)=3n$
        یک چندجمله‌ای است، حدس می‌زنیم که جواب می‌تواند به فرم
        $a_n=cn+d$
        باشد.
        اگر چنین باشد داریم:
        \[cn+d=4c(n-1)+4d+3n\]
        \[\rightarrow n(-3-3c)+(-3d+4c)=0 \]
        \[\rightarrow (-3-3c)=0 \rightarrow c=-1\]
        \[\rightarrow (-3d+4c)=0 \rightarrow d=-\dfrac{3}{4} \]
        \[\rightarrow a_n^{(p)}=-n-\dfrac{3}{4} \]
        \[\rightarrow a_n= a^{(p)}_n+a^{(h)}_n=\alpha 4^n-n-\dfrac{3}{4}\]
    }
\end{PROBLEM}


\NOTE{
    اگر معادله بازگشتی خطی ناهمگن به فرم
    \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}+F(n)\]
    داشته باشیم که
    \[F(n)=(b_tn^t+b_{t-1}n^{t-1}+...+b_1n+b_0)s^n\]
    باشد، آنگاه اگر 
    $s$
    ریشه معادله مشخصه نباشد، معادله دارای جواب خاصی به فرم
    \[(p_tn^t+p_{t-1}n^{t-1}+...+p_1n+p_0)s^n\]
    و اگر
    $s$
    ریشه معادله مشخصه و درجه آن 
    $m$
    باشد، معادله دارای جواب خاصی به فرم
    \[n^m(p_tn^t+p_{t-1}n^{t-1}+...+p_1n+p_0)s^n\]
    است.
}

\begin{PROBLEM}
    \p
    جواب رابطه بازگشتی 
    $a_n=2a_{n-1}-a_{n-2}+n2^n$
    را بیابید.
    \SOLUTION{
        \p
        برای حل این رابطه‌ ابتدا رابطه‌ بازگشتی همگن
        $a_n=2a_{n-1}-a_{n-2}$
        را حل می‌کنیم:
        $$a_n^{(h)}=\alpha_1 1^n+n\alpha_2 1^n$$

        حال جواب خاص معادله را به دست می‌آوریم. با توجه به این که
        $F(n)=2^n\times n$
        است، طبق نکته بالا، جواب به فرم
        $a_n=(cn+d)2^n$
        است.
        داریم:
        \[(cn+d)2^n=2\times2^{n-1}(c(n-1)+d)-(2^{n-2}(c(n-2)+d))+n2^n\]
        \[\rightarrow 4(cn+d)=4(cn-c+d)-(cn-2c+d)+4n \]
        \[\rightarrow (c-4)n+(4d+4c-4d-2c+d)=0 \]
        \[\rightarrow (c-4)=0 \rightarrow c=4\]
        \[\rightarrow (2c+d)=0 \rightarrow d=-8 \]
        \[\rightarrow a_n^{(p)}=(4n-8)2^n \]
        \[\rightarrow a_n= a^{(p)}_n+a^{(h)}_n=\alpha_1+n\alpha_2 +(4n-8)2^n \]
    }

\end{PROBLEM}